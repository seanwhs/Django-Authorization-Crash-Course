# ‚úÖ DJANGO AUTHORIZATION ‚Äì MASTER CHEATSHEET

---

## üîê 1. AUTHENTICATION vs AUTHORIZATION (CORE THEORY)

| Concept        | Meaning          | Django Tools                      |
| -------------- | ---------------- | --------------------------------- |
| Authentication | WHO the user is  | `authenticate()`, `login()`       |
| Authorization  | WHAT user can do | `has_perm()`, Groups, Permissions |

‚úÖ Rule: **AuthN ‚Üí AuthZ ‚Üí Access**

---

## üë§ 2. DEFAULT USER MODEL

```python
from django.contrib.auth.models import User
```

Core Fields:

* username, password (hashed)
* email, first_name, last_name
* is_staff, is_superuser, is_active

DB Table: `auth_user`

---

## üèóÔ∏è 3. CUSTOM USER MODEL (MANDATORY KNOWLEDGE)

### ‚úÖ Using `AbstractUser` (BEST CHOICE)

```python
class CustomUser(AbstractUser):
    role = models.CharField(max_length=20)
    phone = models.CharField(max_length=15)
```

```python
AUTH_USER_MODEL = "accounts.CustomUser"   # settings.py
```

‚úÖ Use when extending default user

---

### ‚úÖ Using `AbstractBaseUser` (ADVANCED ONLY)

* You build everything manually
* Requires custom manager + admin

---

## üë• 4. GROUPS = ROLES

| Group   | Meaning         |
| ------- | --------------- |
| Admins  | Full Access     |
| Editors | Create / Update |
| Viewers | Read Only       |

```python
from django.contrib.auth.models import Group

editors = Group.objects.get(name="Editors")
user.groups.add(editors)
```

---

## üîë 5. PERMISSIONS SYSTEM

Every Model Gets:

```
add_model
change_model
delete_model
view_model
```

Check:

```python
request.user.has_perm("blog.add_post")
```

### ‚úÖ Custom Permission

```python
class Report(models.Model):
    class Meta:
        permissions = [
            ("approve_report", "Can approve report")
        ]
```

---

## üß≠ 6. FUNCTION-BASED VIEW SECURITY

### ‚úÖ Login Required

```python
@login_required
```

---

### ‚úÖ Permission Required

```python
@permission_required("blog.add_post")
```

---

### ‚úÖ Group Restriction

```python
request.user.groups.filter(name="Editors").exists()
```

---

## üß± 7. CLASS-BASED VIEW SECURITY

### ‚úÖ LoginRequiredMixin

```python
class DashboardView(LoginRequiredMixin, View):
```

---

### ‚úÖ PermissionRequiredMixin

```python
class PostCreateView(PermissionRequiredMixin, CreateView):
    permission_required = "blog.add_post"
```

---

### ‚úÖ Object-Level Check (UserPassesTestMixin)

```python
class PostUpdateView(UserPassesTestMixin, UpdateView):
    def test_func(self):
        return self.get_object().author == self.request.user
```

---

## üéØ 8. TEMPLATE AUTHORIZATION

```html
{% if user.is_authenticated %}
```

```html
{% if perms.blog.delete_post %}
```

---

## üîê 9. PASSWORD SECURITY

Enable Validators:

```python
AUTH_PASSWORD_VALIDATORS = [...]
```

Never store raw passwords ‚ùå
Always:

```python
user.set_password("1234")
```

---

## üîÅ 10. LOGIN / LOGOUT VIEWS

```python
from django.contrib.auth.views import LoginView, LogoutView
```

```python
LOGIN_REDIRECT_URL = "/dashboard/"
LOGOUT_REDIRECT_URL = "/login/"
```

---

## üß¨ 11. OBJECT-LEVEL PERMISSIONS

| Method              | Use               |
| ------------------- | ----------------- |
| Filter by owner     | Simple cases      |
| UserPassesTestMixin | Web apps          |
| django-guardian     | True object perms |

---

## üß∞ 12. MIDDLEWARE AUTHORIZATION

Use when:

* Blocking IP addresses
* Restricting routes based on role
* Forcing logout

---

## üîí 13. ENTERPRISE SECURITY SETTINGS

```python
DEBUG = False
SESSION_COOKIE_SECURE = True
CSRF_COOKIE_SECURE = True
SECURE_SSL_REDIRECT = True
```

---

## üåê 14. API AUTHENTICATION (DRF)

| Method      | Best For      |
| ----------- | ------------- |
| SessionAuth | Web           |
| TokenAuth   | Mobile        |
| JWT         | Microservices |

---

## ‚úÖ 15. COMPLETE AUTH FLOW (END-TO-END)

1Ô∏è‚É£ Register User
2Ô∏è‚É£ Hash Password
3Ô∏è‚É£ Assign Group
4Ô∏è‚É£ Check Permission
5Ô∏è‚É£ Grant Access
6Ô∏è‚É£ Audit Security

---

## ‚úÖ 16. INTERVIEW POWER Q&A

**Q:** Difference between permission & group?
‚úÖ Permission = single action
‚úÖ Group = collection of permissions

---

**Q:** Why use `AbstractUser`?
‚úÖ To extend default user safely with minimal risk

---

**Q:** Best way to secure object-level edits?
‚úÖ `UserPassesTestMixin` or `django-guardian`

---

## ‚úÖ 17. DAILY DEVELOPER COMMANDS

```
python manage.py createsuperuser
python manage.py makemigrations
python manage.py migrate
```

